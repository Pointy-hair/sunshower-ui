apply plugin: 'ear'


dependencies {
    earlib project(":service:security")
    deploy project(path: ':web:site', configuration: 'archives')
    deploy project(path:':web:service', configuration:'archives')
}

ear {
    rename { deployment ->
        return stripVersion(deployment)
    }

}

String stripVersion(String input) {
    int fstIndexOf = input.indexOf('-');
    int lastIndexOf = input.lastIndexOf('.');


    if(fstIndexOf > -1 && lastIndexOf > -1) {
        final String extension = input.substring(lastIndexOf, input.length());
        final String fileName = input.substring(0, fstIndexOf);
        return fileName + extension;
    } else {
        return input;
    }
}
